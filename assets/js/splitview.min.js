var splitview=function(){function e(){var e=new RegExp(/^.*\//);return e.exec(window.location.href)}var t,i,n,o,l,r,c,s,u,a,d,p,v={},m={},w=0,f=function(){t=J("root_url",e()[0]),n=J("page_uri",""),o=n,i=J("admin_root","panel/pages/"),l=t+"/"+i+o+"/edit",s=J("time_refresh",100),u=J("time_bar",1e3),r=J("memory",!0),p=J("debug",!1),c=K("orientation","columns"),a=K("view",""),d=K("visible",!1)};v.init=function(e){document.addEventListener("DOMContentLoaded",function(){x()===!0&&(e&&(m=e),f(),P(".splitview--panel",l),P(".splitview--site",t+"/"+n),D(".splitview--panel iframe"),D(".splitview--site iframe"),p===!0&&(console.log("Options JS:"),console.log(m)),r===!0&&_(),y(),H(),B())})};var _=function(){("true"===d||d===!0)&&b(),"columns"===c?h():L(),"panel"===a?A():"site"===a&&W()},y=function(){document.addEventListener("keydown",function(e){e.altKey&&e.keyCode==T()&&(document.querySelector(".splitview").classList.contains("splitview--hide")?b():k())}),document.querySelector(".splitview--panel .splitview__item--back").addEventListener("click",function(){E()}),document.querySelector(".splitview--site .splitview__item--back").addEventListener("click",function(){E()}),document.querySelector(".splitview--panel .splitview__item--full").addEventListener("click",function(){A()}),document.querySelector(".splitview--site .splitview__item--full").addEventListener("click",function(){W()}),document.querySelector(".splitview__item--site a").addEventListener("click",function(e){g(this,e)}),document.querySelector(".splitview--meta .splitview__item--columns").addEventListener("click",function(){h()}),document.querySelector(".splitview--meta .splitview__item--rows").addEventListener("click",function(){L()}),document.querySelector(".splitview__item--refresh").addEventListener("click",function(){U()}),document.querySelector(".splitview--site .splitview__item--sync").addEventListener("click",function(){S()}),document.querySelector(".splitview--panel .splitview__item--sync").addEventListener("click",function(){q()}),document.querySelector(".splitview__item--close").addEventListener("click",function(){k()})},S=function(){l=t+"/"+i+n+"/edit",document.querySelector(".splitview--panel iframe").setAttribute("src",l)},q=function(){page_url=t+"/"+o,document.querySelector(".splitview--site iframe").setAttribute("src",page_url)},g=function(e,t){t.preventDefault(),url=e.getAttribute("href"),O("visible","false"),1==t.which?window.open(url,"_self"):2==t.which&&window.open(url,"_blank")},h=function(){document.querySelector(".splitview").classList.add("splitview--columns"),document.querySelector(".splitview").classList.remove("splitview--rows"),O("orientation","columns")},L=function(){document.querySelector(".splitview").classList.add("splitview--rows"),document.querySelector(".splitview").classList.remove("splitview--columns"),O("orientation","rows")},b=function(){document.querySelector(".splitview").classList.remove("splitview--hide"),j("body"),O("visible","true")},k=function(){document.querySelector(".splitview").classList.add("splitview--hide"),z("body"),O("visible","false")},E=function(){document.querySelector(".splitview").classList.remove("splitview__full--panel","splitview__full--site"),O("view","")},A=function(){document.querySelector(".splitview").classList.add("splitview__full--panel"),O("view","panel")},W=function(){document.querySelector(".splitview").classList.add("splitview__full--site"),O("view","site")},O=function(e,t){C(e)!==t&&(p===!0&&console.log("splitview."+e+": "+t),localStorage.setItem("splitview."+e,t))},C=function(e){return localStorage.getItem("splitview."+e)},T=function(){if(m.hasOwnProperty("shortcut"))var e=m.shortcut;else var e="s";return e.toUpperCase().charCodeAt(0)},x=function(){return window.self===window.top?!0:void 0},P=function(e,t){var i=document.createElement("iframe");return i.src=t,document.querySelector(e).appendChild(i),i},D=function(e){iframe=document.querySelector(e),iframe.onload=function(){w++,2==w&&I()}},I=function(){R(".splitview--panel iframe"),R(".splitview--site iframe"),M(".splitview")},J=function(e,t){var i="";return i=m.hasOwnProperty(e)?m[e]:t},K=function(e,t){var i="";return i=m.hasOwnProperty(e)?m[e]:null!==C(e)?C(e):t},M=function(e){document.querySelector(e).focus()},R=function(e){document.querySelector(e).blur()},U=function(){document.querySelector(".splitview--site iframe").contentWindow.location.reload()},j=function(e){document.querySelector(e).classList.add("splitview--crop")},z=function(e){document.querySelector(e).classList.remove("splitview--crop")},B=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.location.href,t=document.querySelector(".splitview--site iframe").contentWindow.location.href;document.querySelector(".splitview__item--panel .splitview__link").setAttribute("href",e),document.querySelector(".splitview__item--site .splitview__link").setAttribute("href",t),F();var i=document.querySelector(".splitview--site iframe").contentWindow.document.querySelector(".splitview__data");i&&(n=i.getAttribute("data-splitview-id")),setTimeout(B,u)},F=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.location.href,n=t+"/"+i,l=e.replace(n,""),r=l.split("/file/");admin_uri_page=G("/edit",r[0]),admin_uri_page=G("/files",admin_uri_page),admin_uri_page=G("/subpages",admin_uri_page),-1==admin_uri_page.indexOf(t)&&(o=admin_uri_page)},G=function(e,t){return str=t.slice(-e.length),str===e&&(t=t.slice(0,-e.length)),t},H=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.document.querySelector(".message-content");e?(U(),N()):setTimeout(H,s)},N=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.document.querySelector(".message-content");e?setTimeout(N,s):setTimeout(H,s)};return v}();
