var splitview=function(){function e(){var e=new RegExp(/^.*\//);return e.exec(window.location.href)}var t,i,n,o,l,c,r,s,u,a,d,p={},v={},m=0,w=function(){t=I("root_url",e()[0]),n=I("page_uri",""),o=n,i=I("admin_root","panel/pages/"),l=t+"/"+i+o+"/edit",s=I("time_refresh",100),c=I("memory",!0),d=I("debug",!1),r=J("orientation","columns"),u=J("view",""),a=J("visible",!1)};p.init=function(e){document.addEventListener("DOMContentLoaded",function(){T()===!0&&(e&&(v=e),w(),x(".splitview--panel",l),x(".splitview--site",t+"/"+n),P(".splitview--panel iframe"),P(".splitview--site iframe"),d===!0&&(console.log("Options JS:"),console.log(v)),c===!0&&f(),_(),G(),z())})};var f=function(){("true"===a||a===!0)&&L(),"columns"===r?g():h(),"panel"===u?E():"site"===u&&A()},_=function(){document.addEventListener("keydown",function(e){e.altKey&&e.keyCode==C()&&(document.querySelector(".splitview").classList.contains("splitview--hide")?L():b())}),document.querySelector(".splitview--panel .splitview__item--back").addEventListener("click",function(){k()}),document.querySelector(".splitview--site .splitview__item--back").addEventListener("click",function(){k()}),document.querySelector(".splitview--panel .splitview__item--full").addEventListener("click",function(){E()}),document.querySelector(".splitview--site .splitview__item--full").addEventListener("click",function(){A()}),document.querySelector(".splitview__item--site a").addEventListener("click",function(e){q(this,e)}),document.querySelector(".splitview--meta .splitview__item--columns").addEventListener("click",function(){g()}),document.querySelector(".splitview--meta .splitview__item--rows").addEventListener("click",function(){h()}),document.querySelector(".splitview__item--refresh").addEventListener("click",function(){R()}),document.querySelector(".splitview--site .splitview__item--sync").addEventListener("click",function(){y()}),document.querySelector(".splitview--panel .splitview__item--sync").addEventListener("click",function(){S()}),document.querySelector(".splitview__item--close").addEventListener("click",function(){b()})},y=function(){l=t+"/"+i+n+"/edit",document.querySelector(".splitview--panel iframe").setAttribute("src",l)},S=function(){page_url=t+"/"+o,document.querySelector(".splitview--site iframe").setAttribute("src",page_url)},q=function(e,t){t.preventDefault(),url=e.getAttribute("href"),W("visible","false"),1==t.which?window.open(url,"_self"):2==t.which&&window.open(url,"_blank")},g=function(){document.querySelector(".splitview").classList.add("splitview--columns"),document.querySelector(".splitview").classList.remove("splitview--rows"),W("orientation","columns")},h=function(){document.querySelector(".splitview").classList.add("splitview--rows"),document.querySelector(".splitview").classList.remove("splitview--columns"),W("orientation","rows")},L=function(){document.querySelector(".splitview").classList.remove("splitview--hide"),U("body"),W("visible","true")},b=function(){document.querySelector(".splitview").classList.add("splitview--hide"),j("body"),W("visible","false")},k=function(){document.querySelector(".splitview").classList.remove("splitview__full--panel","splitview__full--site"),W("view","")},E=function(){document.querySelector(".splitview").classList.add("splitview__full--panel"),W("view","panel")},A=function(){document.querySelector(".splitview").classList.add("splitview__full--site"),W("view","site")},W=function(e,t){O(e)!==t&&(d===!0&&console.log("splitview."+e+": "+t),localStorage.setItem("splitview."+e,t))},O=function(e){return localStorage.getItem("splitview."+e)},C=function(){if(v.hasOwnProperty("shortcut"))var e=v.shortcut;else var e="s";return e.toUpperCase().charCodeAt(0)},T=function(){return window.self===window.top?!0:void 0},x=function(e,t){var i=document.createElement("iframe");return i.src=t,document.querySelector(e).appendChild(i),i},P=function(e){iframe=document.querySelector(e),iframe.onload=function(){m++,2==m&&D()}},D=function(){M(".splitview--panel iframe"),M(".splitview--site iframe"),K(".splitview")},I=function(e,t){var i="";return i=v.hasOwnProperty(e)?v[e]:t},J=function(e,t){var i="";return i=v.hasOwnProperty(e)?v[e]:null!==O(e)?O(e):t},K=function(e){document.querySelector(e).focus()},M=function(e){document.querySelector(e).blur()},R=function(){document.querySelector(".splitview--site iframe").contentWindow.location.reload()},U=function(e){document.querySelector(e).classList.add("splitview--crop")},j=function(e){document.querySelector(e).classList.remove("splitview--crop")},z=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.location.href,t=document.querySelector(".splitview--site iframe").contentWindow.location.href;document.querySelector(".splitview__item--panel .splitview__link").setAttribute("href",e),document.querySelector(".splitview__item--site .splitview__link").setAttribute("href",t),B();var i=document.querySelector(".splitview--site iframe").contentWindow.document.querySelector(".splitview__data");i&&(n=i.getAttribute("data-splitview-id")),setTimeout(z,1e3)},B=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.location.href,n=t+"/"+i,l=e.replace(n,""),c=l.split("/file/");admin_uri_page=F("/edit",c[0]),admin_uri_page=F("/files",admin_uri_page),admin_uri_page=F("/subpages",admin_uri_page),-1==admin_uri_page.indexOf(t)&&(o=admin_uri_page)},F=function(e,t){return str=t.slice(-e.length),str===e&&(t=t.slice(0,-e.length)),t},G=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.document.querySelector(".message-content");e?(R(),H()):setTimeout(G,s)},H=function(){var e=document.querySelector(".splitview--panel iframe").contentWindow.document.querySelector(".message-content");e?setTimeout(H,s):setTimeout(G,s)};return p}();
