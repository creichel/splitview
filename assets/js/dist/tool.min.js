var splitview=function(){var e,n,t,i={},o={},c=0,s=!0;i.init=function(){document.addEventListener("DOMContentLoaded",function(){l(),v(),_("section.panel .iframe",e),_("section.site .iframe",n),console.log(o),g("section.panel .url input",e),g("section.site .url input",n),u("section.panel iframe"),u("section.site iframe"),a(),G()})};var a=function(){console.log(o),o.memory===!0&&(O(r("orientation","columns")),A(r("view","grid")))},r=function(e,n){var t="";return t=o.hasOwnProperty(e)?o[e]:n},l=function(){o=JSON.parse(localStorage.getItem("splitview.data")),console.log(o),e=o.root_url+"/panel/pages/"+o.admin_slug+"/edit",n=o.root_url+"/"+o.page_slug},u=function(e){iframe=w(e),iframe.onload=function(){c++,2==c&&(p(),d(),J())}},d=function(){style_element=document.createElement("style"),node=w("section.panel iframe").contentWindow.document.querySelector("body").appendChild(style_element),node.innerHTML=".message { display: none; }"},f=function(e){w(e).focus()},m=function(e){w(e).blur()},p=function(){m("section.panel iframe"),m("section.site iframe"),f(".splitview")},v=function(){o.debug===!0&&(console.log("Options JS:"),console.log(o))},g=function(e,n){w(e).value=n},_=function(e,n){var t=document.createElement("iframe");return t.src=n,w(e).appendChild(t),t},w=function(e){return document.querySelector(e)},y=function(e,n){n=n||document;var t=n.querySelectorAll(e);return Array.prototype.slice.call(t)},L=function(e){y("li."+e).forEach(function(n){n.addEventListener("click",function(n){A(e)})})},h=function(e){y("li."+e).forEach(function(n){n.addEventListener("click",function(n){O(e),A("grid")})})},E=function(){y("li.close-dropdown").forEach(function(e){e.addEventListener("click",function(e){C(this)})})},S=function(e){w("section."+e+" li.refresh").addEventListener("click",function(n){q("section."+e+" iframe")})},b=function(e){w("section."+e+" .url input").addEventListener("keypress",function(){if(13==event.keyCode){var n=w("section."+e+" .url input").value;w("section."+e+" iframe").setAttribute("src",n)}})},W=function(e){y("li.close-"+e).forEach(function(n){n.addEventListener("click",function(n){window.location.href=w("section."+e+" iframe").contentWindow.document.location.href})})},k=function(){window.addEventListener("click",function(e){e=e||window.event;var n=e.target||e.srcElement,t=n.getAttribute("class");"fa fa-sign-out"!==t&&"close-dropdown"!==t&&y("li.close-dropdown ul.dropdown").forEach(function(e){e.classList.remove("active")})})},q=function(e){w(e).contentWindow.location.reload()},A=function(e){w("body").setAttribute("data-view",e),T("view",e)},O=function(e){w("body").setAttribute("data-orientation",e),T("orientation",e)},C=function(e){e.querySelector(".dropdown").classList.toggle("active")},T=function(e,n){o[e]!==n&&(o.debug===!0&&console.log("splitview."+e+": "+n),o[e]=n,localStorage.setItem("splitview.data",JSON.stringify(o)))},J=function(){N(),M(),I(),setTimeout(J,200)},I=function(){element=w("section.panel iframe").contentWindow.document.querySelector(".message-is-alert"),element&&(element.remove(),w("section.panel .message-error").classList.add("active"),w("section.site .message-error").classList.add("active"),setTimeout(D,4e3))},M=function(){element=w("section.panel iframe").contentWindow.document.querySelector(".message-is-notice"),element?t="saved":(s=!1,t="closed"),"saved"===t&&0==s&&(element.remove(),w("section.panel .message-saved").classList.add("active"),w("section.site .message-saved").classList.add("active"),q("section.site iframe"),s=!0,setTimeout(x,4e3))},N=function(){new_site_url=w("section.site iframe").contentWindow.location.href,new_panel_url=w("section.panel iframe").contentWindow.location.href,n!=new_site_url&&(g("section.site .url input",new_site_url),n=new_site_url),e!=new_panel_url&&(g("section.panel .url input",new_panel_url),e=new_panel_url)},x=function(e){w("section.panel .message-saved").classList.remove("active"),w("section.site .message-saved").classList.remove("active")},D=function(e){w("section.panel .message-error").classList.remove("active"),w("section.site .message-error").classList.remove("active")},H=function(){var e=document.querySelector("section.site iframe"),n=e.contentWindow.document.querySelector(".splitview-data").getAttribute("data-splitview-id");w("section.panel iframe").contentWindow.document.location.href=o.root_url+"/panel/pages/"+n+"/edit"},P=function(){var e=w("section.panel iframe").contentWindow.location.href,n=o.root_url+"/panel/pages",t=e.replace(n,""),i=t.split("/file/");admin_uri_page=j("/edit",i[0]),admin_uri_page=j("/files",admin_uri_page),admin_uri_page=j("/subpages",admin_uri_page),-1==admin_uri_page.indexOf(o.root_url)&&(admin_uri=admin_uri_page),new_site_url=o.root_url+admin_uri,w("section.site iframe").contentWindow.location.href=new_site_url},j=function(e,n){return str=n.slice(-e.length),str===e&&(n=n.slice(0,-e.length)),n},z=function(e){y(e).forEach(function(e){e.addEventListener("click",function(e){H()})})},B=function(e){y(e).forEach(function(e){e.addEventListener("click",function(e){P()})})},F=function(e){W(e),L(e),b(e),S(e)},G=function(){E(),k(),h("columns"),h("rows"),F("panel"),F("site"),z("section.site .sync"),B("section.panel .sync")};return i}();